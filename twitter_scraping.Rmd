---
title: "Tweets in R"
author: "Jonathan RystrÃ¸m"
date: "12/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## What will we learn
- authenticating (only needs a twitter account!)
- NLP generelt?
- searching tweets (how to do that)
	- Words, literals, OR...--> view `help(search_tweets)`
- What do we do with all the attributes (the most important ones?)
	- status_id, screen_name, created_at, text, likes and retweets
- Searching users
	- Example with POTUS
- Searching older tweets
	- check out [this resource](https://github.com/alexandrainst/danlp/blob/master/docs/docs/datasets.md#angrytweets)
	- Needs to have the tweet ID <-- policy
- Caveats
	- Max 18k tweets (rate limits)
	- Only 6-9 recent days

### Loading Packages
```{r}
pacman::p_load(rtweet, tidyverse, tidytext)
```



```{r}
raw_tweet <- search_tweets("#dkpol", n=2000)
```

```{r}
tweet <- raw_tweet %>% 
	select(created_at, screen_name, text, favourites_count, retweet_count)
```
# First analysis
- What are the oldest and most recent tweets?
```{r}
tweet %>% 
	summarise(earliest_tweet = min(created_at), 
						lateset_tweet = max(created_at))
```
What are the five most popular tweets?
```{r}
top_tweets <- tweet %>% 
	slice_max(order_by=favorite_count, n=5) %>% 
	select(screen_name, favorite_count, text)	
View(top_tweets)

max(tweet$favorite_count)
```

What are the most used words?
```{r}
tweet %>% 
	unnest_tokens(word, text) %>% 
	count(word, sort=TRUE)
```

```{r}
stopord_url <- "https://gist.githubusercontent.com/berteltorp/0cf8a0c7afea7f25ed754f24cfc2467b/raw/305d8e3930cc419e909d49d4b489c9773f75b2d6/stopord.txt"
stop_ord <- read_table(stopord_url, col_names = FALSE)
andre_stopord <- c("https", "t.co")
stopord_vec <- c(stop_ord$X1, andre_stopord)

```

```{r}
tweet_words <- tweet %>% 
	unnest_tokens(word, text) %>% 
	filter(!(word %in% stopord_vec)) %>% 
	count(word, sort=TRUE)
```

## Search Exercises
*Remember to assign your results to variables as we're gonna use them later!*
Q1: Scrape 3000 recent tweets from the hashtag #covid19dk not involving retweets (HINT: check ?search_tweets)
Q2: Scrape 3000 popular tweets involving cultural data science (HINT: Remember that "data science" is a literal concept)
Q3: Scrape 3000 recent tweets about climate change (you figure out a suitable search string)

## Analysis Exercises
Q


## Visualization Exercises



